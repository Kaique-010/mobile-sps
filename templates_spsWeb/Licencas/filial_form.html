{% extends 'base.html' %}
{% load static %}
{% block title %}Cadastrar Filial{% endblock %}
{% block content %}

<link rel="stylesheet" href="{% static 'css/form.css' %}">
<div class="container py-4">
  <div class="card shadow-lg border-0">
    <div class="card-header text-center py-3">
      <h3 class="mb-0 d-flex align-items-center justify-content-center">
        <i class="bi bi-buildings me-2"></i> Cadastro de Filial
      </h3>

    </div>
  </div>


  {% if form.errors %}
  <div class="alert alert-danger alert-dismissible fade show" role="alert">
    <strong>Erro:</strong> Corrija os erros abaixo.
    <ul class="mt-2 mb-0 list-unstyled">
      {% for field in form %}
      {% if field.errors %}
      <li><strong>{{ field.label }}:</strong> {{ field.errors|striptags }}</li>
      {% endif %}
      {% endfor %}
      {% if form.non_field_errors %}
      <li><strong>Formulário:</strong> {{ form.non_field_errors|striptags }}</li>
      {% endif %}
    </ul>
    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
  </div>
  {% endif %}
  {% if form.non_field_errors %}
  <div class="alert alert-danger alert-dismissible fade show" role="alert">
    {{ form.non_field_errors|striptags }}
    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
  </div>
  {% endif %}

  <div class="card">
    <div class="card-body">
      <form method="post" enctype="multipart/form-data">
        {% csrf_token %}

        <ul class="nav nav-tabs" id="filialTabs">
          <li class="nav-item">
            <a class="nav-link active" id="principal-tab" data-bs-toggle="tab" href="#principal">Dados Principais</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="endereco-tab" data-bs-toggle="tab" href="#endereco">Endereço</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="contato-tab" data-bs-toggle="tab" href="#contato">Contato</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="certificados-tab" data-bs-toggle="tab" href="#certificados">Certificados
              Digitais</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="smtp-tab" data-bs-toggle="tab" href="#smtp">SMTP</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" id="nfe-tab" data-bs-toggle="tab" href="#nfe">NF-e/CT-e/NFS-e</a>
          </li>

        </ul>

        <div class="tab-content mt-3">

          <div class="tab-pane fade show active" id="principal">
            {% include 'Licencas/abas/filial_principal.html' %}
          </div>

          <div class="tab-pane fade" id="endereco">
            {% include 'Licencas/abas/filial_endereco.html' %}
          </div>

          <div class="tab-pane fade" id="contato">
            {% include 'Licencas/abas/filial_contato.html' %}
          </div>

          <div class="tab-pane fade" id="certificados">
            {% include 'Licencas/abas/filial_certificados.html' %}
          </div>

          <div class="tab-pane fade" id="smtp">
            {% include 'Licencas/abas/filial_smtp.html' %}
          </div>


          <div class="tab-pane fade" id="nfe">
            {% include 'Licencas/abas/filial_nfe.html' %}
          </div>

          <div class="tab-pane fade" id="outras">
            {% include 'Licencas/abas/filial_outras.html' %}
          </div>
        </div>

      <div class="mt-3 form-actions">
        <button type="submit" class="btn btn-primary"><i class="bi bi-check-circle"></i> Salvar</button>
        <a href="{% url 'filiais_web' slug=slug %}" class="btn btn-secondary">Cancelar</a>
      </div>
      </form>
    </div>
  </div>

  <form id="certificadoUploadForm" action="{% url 'web_licencas_certificado' slug=slug %}" method="post" enctype="multipart/form-data" style="display:none;">
    {% csrf_token %}
  </form>

</div>
{% endblock %}

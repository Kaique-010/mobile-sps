{% extends 'base.html' %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="{% static 'css/list.css' %}">
<div class="container py-3">
  <h3 class="page-title">Contas a Pagar</h3>
  <form method="get" class="row g-2 mb-3">
    <div class="col-auto">
      <select name="period" class="form-select form-select-sm">
        <option value="hoje" {% if period == 'hoje' %}selected{% endif %}>Hoje</option>
        <option value="semana" {% if period == 'semana' %}selected{% endif %}>Semana</option>
      </select>
    </div>
    <div class="col-auto">
      <select name="status" class="form-select form-select-sm">
        <option value="">Todos</option>
        <option value="aberto" {% if request.GET.status == 'aberto' %}selected{% endif %}>Abertos</option>
        <option value="quitado" {% if request.GET.status == 'quitado' %}selected{% endif %}>Quitados</option>
      </select>
    </div>
    <div class="col-auto"><button class="btn btn-sm btn-primary" type="submit">Filtrar</button></div>
  </form>
  <div class="table-responsive">
    <table class="table table-sm align-middle">
      <thead>
        <tr>
          <th>Título</th>
          <th>Fornecedor</th>
          <th>Nome fornecedor</th>
          <th>Valor</th>
          <th>Parcela</th>
          <th>Vencimento</th>
          <th>Estado</th>
        </tr>
      </thead>
      <tbody>
        {% for t in object_list %}
        <tr>
          <td>{{ t.titu_titu }}</td>
          <td>{{ t.titu_forn }}</td>
          <td>{{ t.fornecedor_nome }}</td>
          <td>{{ t.titu_valo }}</td>
          <td>{{ t.titu_parc }}</td>
          <td>{{ t.titu_venc }}</td>
          <td>
            {% if t.titu_aber == 'T' %}
            <span class="badge bg-secondary">Quitado</span>
            {% else %}
            {% if t.titu_venc == today %}
            <span class="badge bg-warning text-dark">Vence Hoje</span>
            {% elif t.titu_venc < today %}
            <span class="badge bg-danger">Vencido</span>
            {% else %}
            <span class="badge bg-primary">Aberto</span>
            {% endif %}
            {% endif %}
          </td>
        </tr>
        {% empty %}
        <tr><td colspan="4" class="text-center">Sem registros</td></tr>
        {% endfor %}
      </tbody>
      <tfoot>
        <tr>
          <th colspan="3" class="text-end">Totais</th>
          <th>{{ total_sum|floatformat:2 }}</th>
          <th colspan="3">Títulos: {{ total_count }}</th>
        </tr>
      </tfoot>
    </table>
  </div>
  {% include 'components/pagination.html' %}
</div>
{% endblock %}
